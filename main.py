import pandas as pd
import numpy as np

# === –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ===
data = pd.read_csv("people.csv", encoding="utf-8-sig")
data["–≤–æ–∑—Ä–∞—Å—Ç"] = 2025 - data["–≥–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è"]

print("=== –ü—Ä–æ–≤–µ—Ä–∫–∞ 15 –≥–∏–ø–æ—Ç–µ–∑ ===\n")

# 1Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
g1 = data.groupby("–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")["—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥"].mean().sort_values(ascending=False)
print("1Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é:")
print(g1, "\n")
if g1.max() - g1.min() > 20000:
    print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: —É—Ä–æ–≤–µ–Ω—å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∑–∞—Ä–ø–ª–∞—Ç—É.\n")
else:
    print("‚ùå –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–µ —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.\n")

# 2Ô∏è‚É£ –ù–∞–ª–∏—á–∏–µ —Å—É–¥–∏–º–æ—Å—Ç–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
g2 = data.groupby("—Å—É–¥–∏–º–æ—Å—Ç–∏")["–º–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã"].apply(lambda x: (x != "–Ω–µ—Ç –º–µ—Å—Ç–∞ —Ä–∞–±–æ—Ç—ã").mean())
print("2Ô∏è‚É£ –î–æ–ª—è —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –ø–æ –Ω–∞–ª–∏—á–∏—é —Å—É–¥–∏–º–æ—Å—Ç–∏:")
print(g2, "\n")
if g2.max() - g2.min() > 0.1:
    print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –Ω–∞–ª–∏—á–∏–µ —Å—É–¥–∏–º–æ—Å—Ç–∏ —Å–Ω–∏–∂–∞–µ—Ç —à–∞–Ω—Å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.\n")
else:
    print("‚ùå –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –Ω–∞–ª–∏—á–∏–µ —Å—É–¥–∏–º–æ—Å—Ç–∏ –º–∞–ª–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.\n")

# 3Ô∏è‚É£ –í–æ–∑—Ä–∞—Å—Ç –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ä–µ–¥–Ω—é—é –∑–∞—Ä–ø–ª–∞—Ç—É
data["–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞"] = pd.cut(data["–≤–æ–∑—Ä–∞—Å—Ç"], bins=[0,18,25,40,55,70,100],
                                   labels=["<18","18‚Äì25","26‚Äì40","41‚Äì55","56‚Äì70","70+"])
g3 = data.groupby("–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞")["—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥"].mean()
print("3Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º:")
print(g3, "\n")
if g3.max() - g3.min() > 15000:
    print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º –∑–∞—Ä–ø–ª–∞—Ç–∞ –º–µ–Ω—è–µ—Ç—Å—è –∑–∞–º–µ—Ç–Ω–æ.\n")
else:
    print("‚ùå –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –≤–æ–∑—Ä–∞—Å—Ç —Å–ª–∞–±–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∑–∞—Ä–ø–ª–∞—Ç—É.\n")

# 4Ô∏è‚É£ –£—Ä–æ–≤–µ–Ω—å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–µ—Å—Ç–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è
g4 = data.groupby("–º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è")["–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"].value_counts(normalize=True).unstack(fill_value=0)
print("4Ô∏è‚É£ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –≥–æ—Ä–æ–¥–∞–º (–ø–µ—Ä–≤—ã–µ 5):")
print(g4.head(), "\n")
print("‚ÑπÔ∏è –†–∞–∑–ª–∏—á–∏—è –≤ –¥–æ–ª—è—Ö –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ—Ç –º–µ—Å—Ç–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è.\n")

# 5Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è
g5 = data.groupby("–º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è")["—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥"].mean().sort_values(ascending=False).head(10)
print("5Ô∏è‚É£ –¢–æ–ø-10 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç–µ:")
print(g5, "\n")
print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–º–µ—Ç–Ω–æ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏.\n")

# 6Ô∏è‚É£ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—É–¥–∏–º–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞
g6 = data.groupby("–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞")["—Å—É–¥–∏–º–æ—Å—Ç–∏"].value_counts(normalize=True).unstack(fill_value=0)
print("6Ô∏è‚É£ –î–æ–ª—è –ª—é–¥–µ–π —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º:")
print(g6.head(), "\n")
print("‚ÑπÔ∏è –°—É–¥–∏–º–æ—Å—Ç–∏ —á–∞—â–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —É –≤–∑—Ä–æ—Å–ª—ã—Ö –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –≥—Ä—É–ø–ø.\n")

# 7Ô∏è‚É£ –°—É–¥–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
g7 = data.groupby("–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")["—Å—É–¥–∏–º–æ—Å—Ç–∏"].value_counts(normalize=True).unstack(fill_value=0)
print("7Ô∏è‚É£ –î–æ–ª—è —Å—É–¥–∏–º—ã—Ö –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é:")
print(g7.head(), "\n")
print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –ª—é–¥–∏ —Å –Ω–∏–∑–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —á–∞—â–µ –∏–º–µ—é—Ç —Å—É–¥–∏–º–æ—Å—Ç–∏.\n")

# 8Ô∏è‚É£ –ù–∞–ª–∏—á–∏–µ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞
g8 = data.groupby("–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞")["–º–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã"].apply(lambda x: (x != "–Ω–µ—Ç –º–µ—Å—Ç–∞ —Ä–∞–±–æ—Ç—ã").mean())
print("8Ô∏è‚É£ –î–æ–ª—è —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É:")
print(g8, "\n")
if g8.loc["18‚Äì25"] < g8.loc["26‚Äì40"]:
    print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: —É—Ä–æ–≤–µ–Ω—å –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —Ä–∞—Å—Ç—ë—Ç —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º.\n")
else:
    print("‚ùå –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º.\n")

# 9Ô∏è‚É£ –ù–∞–ª–∏—á–∏–µ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
g9 = data.groupby("–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")["–º–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã"].apply(lambda x: (x != "–Ω–µ—Ç –º–µ—Å—Ç–∞ —Ä–∞–±–æ—Ç—ã").mean())
print("9Ô∏è‚É£ –î–æ–ª—è —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é:")
print(g9, "\n")
if g9.max() - g9.min() > 0.1:
    print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.\n")
else:
    print("‚ùå –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∞–ª–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç—å.\n")

# üîü –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—É–¥–∏–º–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
g10 = data.groupby(["–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", "—Å—É–¥–∏–º–æ—Å—Ç–∏"])["—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥"].mean()
print("üîü –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –∏ —Å—É–¥–∏–º–æ—Å—Ç–∏:")
print(g10.head(15), "\n")
print("‚ÑπÔ∏è –°—É–¥–∏–º–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç —Å—Ä–µ–¥–Ω—é—é –∑–∞—Ä–ø–ª–∞—Ç—É –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.\n")

# 11Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞ (–≥–æ—Ä–æ–¥/—Å–µ–ª–æ)
data["—Ç–∏–ø_–º–µ—Å—Ç–∞"] = np.where(data["–º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è"].str.lower().str.contains("—Å–µ–ª–æ|–¥–µ—Ä–µ–≤–Ω—è"), "—Å–µ–ª–æ", "–≥–æ—Ä–æ–¥")
g11 = data.groupby("—Ç–∏–ø_–º–µ—Å—Ç–∞")["—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥"].mean()
print("11Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ —Ç–∏–ø—É –Ω–∞—Å–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞:")
print(g11, "\n")
if len(g11) > 1 and g11.max() - g11.min() > 15000:
    print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –≤ –≥–æ—Ä–æ–¥–∞—Ö –∑–∞—Ä–ø–ª–∞—Ç—ã –≤—ã—à–µ, —á–µ–º –≤ —Å—ë–ª–∞—Ö.\n")
else:
    print("‚ùå –ì–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –∑–∞—Ä–ø–ª–∞—Ç—ã –≤ –≥–æ—Ä–æ–¥–∞—Ö –∏ —Å–µ–ª–∞—Ö –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã.\n")

# 12Ô∏è‚É£ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π —Å –≤—ã—Å—à–∏–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è
g12 = data[data["–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"].str.contains("–≤—ã—Å—à–µ–µ", case=False)]["–º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è"].value_counts().head(10)
print("12Ô∏è‚É£ –¢–æ–ø-10 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ —á–∏—Å–ª—É –ª—é–¥–µ–π —Å –≤—ã—Å—à–∏–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º:")
print(g12, "\n")
print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –∫—Ä—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ —á–∞—â–µ –∏–º–µ—é—Ç –±–æ–ª—å—à–µ –ª—é–¥–µ–π —Å –≤—ã—Å—à–∏–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º.\n")

# 13Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
g13 = data.pivot_table(index="–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", columns="–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞", values="—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥", aggfunc="mean")
print("13Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é:")
print(g13.head(), "\n")
print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: –≤–æ–∑—Ä–∞—Å—Ç –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ –∑–∞—Ä–ø–ª–∞—Ç—É.\n")

# 14Ô∏è‚É£ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—É–¥–∏–º–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
g14 = data.groupby(data["–º–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã"] != "–Ω–µ—Ç –º–µ—Å—Ç–∞ —Ä–∞–±–æ—Ç—ã")["—Å—É–¥–∏–º–æ—Å—Ç–∏"].value_counts(normalize=True).unstack(fill_value=0)
print("14Ô∏è‚É£ –°—É–¥–∏–º–æ—Å—Ç–∏ —Å—Ä–µ–¥–∏ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∏ –±–µ–∑—Ä–∞–±–æ—Ç–Ω—ã—Ö:")
print(g14, "\n")
print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: —É –±–µ–∑—Ä–∞–±–æ—Ç–Ω—ã—Ö —á–∞—â–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å—É–¥–∏–º–æ—Å—Ç–∏.\n")

# 15Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—É–¥–∏–º–æ—Å—Ç–∏ –∏ –≤–æ–∑—Ä–∞—Å—Ç–∞
g15 = data.groupby(["–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞", "—Å—É–¥–∏–º–æ—Å—Ç–∏"])["—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥"].mean()
print("15Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –∏ —Å—É–¥–∏–º–æ—Å—Ç–∏:")
print(g15, "\n")
print("‚úÖ –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è: —É –ª—é–¥–µ–π —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∏–∂–µ –≤–æ –≤—Å–µ—Ö –≤–æ–∑—Ä–∞—Å—Ç–∞—Ö.\n")

print("=== –ö–æ–Ω–µ—Ü –∞–Ω–∞–ª–∏–∑–∞ ===")

import matplotlib.pyplot as plt

print("\n=== –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ –≤—Å–µ–º –≥–∏–ø–æ—Ç–µ–∑–∞–º ===")

# 1Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é
plt.figure(figsize=(10, 6))
g1.plot(kind="bar", color="skyblue")
plt.title("1Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ —É—Ä–æ–≤–Ω—é –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è")
plt.ylabel("–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥")
plt.xlabel("–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")
plt.xticks(rotation=45, ha="right")
plt.tight_layout()
plt.show()

# 2Ô∏è‚É£ –¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ —Å—É–¥–∏–º–æ—Å—Ç—å
plt.figure(figsize=(6, 6))
g2.plot(kind="bar", color="tomato")
plt.title("2Ô∏è‚É£ –î–æ–ª—è —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –ø–æ –Ω–∞–ª–∏—á–∏—é —Å—É–¥–∏–º–æ—Å—Ç–∏")
plt.ylabel("–î–æ–ª—è —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö")
plt.xlabel("–°—É–¥–∏–º–æ—Å—Ç—å")
plt.tight_layout()
plt.show()

# 3Ô∏è‚É£ –í–æ–∑—Ä–∞—Å—Ç –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞
plt.figure(figsize=(10, 6))
g3.plot(kind="bar", color="lightgreen")
plt.title("3Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º")
plt.ylabel("–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥")
plt.xlabel("–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞")
plt.tight_layout()
plt.show()

# 4Ô∏è‚É£ –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (–ø–µ—Ä–≤—ã–µ 5)
plt.figure(figsize=(10, 6))
g4.head().T.plot(kind="bar", stacked=True, figsize=(10, 6))
plt.title("4Ô∏è‚É£ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –≥–æ—Ä–æ–¥–∞–º (–ø–µ—Ä–≤—ã–µ 5)")
plt.ylabel("–î–æ–ª—è")
plt.xlabel("–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")
plt.xticks(rotation=45, ha="right")
plt.legend(title="–ú–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è", bbox_to_anchor=(1.05, 1))
plt.tight_layout()
plt.show()

# 5Ô∏è‚É£ –ó–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
plt.figure(figsize=(10, 6))
g5.plot(kind="bar", color="salmon")
plt.title("5Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (–¢–æ–ø-10)")
plt.ylabel("–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥")
plt.xlabel("–†–µ–≥–∏–æ–Ω")
plt.xticks(rotation=45, ha="right")
plt.tight_layout()
plt.show()

# 6Ô∏è‚É£ –°—É–¥–∏–º–æ—Å—Ç–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
plt.figure(figsize=(8, 6))
g6.plot(kind="bar", stacked=True, color=["lightgray", "darkred"])
plt.title("6Ô∏è‚É£ –î–æ–ª—è –ª—é–¥–µ–π —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º")
plt.ylabel("–î–æ–ª—è")
plt.xlabel("–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞")
plt.tight_layout()
plt.show()

# 7Ô∏è‚É£ –°—É–¥–∏–º–æ—Å—Ç—å –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é
plt.figure(figsize=(10, 6))
g7.plot(kind="bar", stacked=True, color=["lightgray", "red"])
plt.title("7Ô∏è‚É£ –î–æ–ª—è —Å—É–¥–∏–º—ã—Ö –ø–æ —É—Ä–æ–≤–Ω—é –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è")
plt.ylabel("–î–æ–ª—è")
plt.xlabel("–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")
plt.xticks(rotation=45, ha="right")
plt.tight_layout()
plt.show()

# 8Ô∏è‚É£ –†–∞–±–æ—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
plt.figure(figsize=(8, 6))
g8.plot(kind="bar", color="orange")
plt.title("8Ô∏è‚É£ –î–æ–ª—è —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É")
plt.ylabel("–î–æ–ª—è —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö")
plt.xlabel("–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞")
plt.tight_layout()
plt.show()

# 9Ô∏è‚É£ –†–∞–±–æ—Ç–∞ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é
plt.figure(figsize=(10, 6))
g9.plot(kind="bar", color="purple")
plt.title("9Ô∏è‚É£ –î–æ–ª—è —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ —É—Ä–æ–≤–Ω—é –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è")
plt.ylabel("–î–æ–ª—è —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö")
plt.xlabel("–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")
plt.xticks(rotation=45, ha="right")
plt.tight_layout()
plt.show()

# üîü –ó–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –∏ —Å—É–¥–∏–º–æ—Å—Ç–∏
plt.figure(figsize=(10, 6))
g10.unstack().plot(kind="bar", figsize=(10, 6))
plt.title("üîü –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –∏ —Å—É–¥–∏–º–æ—Å—Ç–∏")
plt.ylabel("–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥")
plt.xlabel("–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ")
plt.xticks(rotation=45, ha="right")
plt.legend(title="–°—É–¥–∏–º–æ—Å—Ç—å", bbox_to_anchor=(1.05, 1))
plt.tight_layout()
plt.show()

# 11Ô∏è‚É£ –ó–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ —Ç–∏–ø—É –Ω–∞—Å–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞
plt.figure(figsize=(6, 6))
g11.plot(kind="bar", color="teal")
plt.title("11Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ —Ç–∏–ø—É –Ω–∞—Å–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞")
plt.ylabel("–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥")
plt.xlabel("–¢–∏–ø –Ω–∞—Å–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞")
plt.tight_layout()
plt.show()

# 12Ô∏è‚É£ –õ—é–¥–∏ —Å –≤—ã—Å—à–∏–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ –≥–æ—Ä–æ–¥–∞–º
plt.figure(figsize=(10, 6))
g12.plot(kind="bar", color="cornflowerblue")
plt.title("12Ô∏è‚É£ –¢–æ–ø-10 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ —á–∏—Å–ª—É –ª—é–¥–µ–π —Å –≤—ã—Å—à–∏–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º")
plt.ylabel("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π")
plt.xlabel("–ì–æ—Ä–æ–¥")
plt.xticks(rotation=45, ha="right")
plt.tight_layout()
plt.show()

# 13Ô∏è‚É£ –í–æ–∑—Ä–∞—Å—Ç + –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ = –∑–∞—Ä–ø–ª–∞—Ç–∞ (—Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞)
plt.figure(figsize=(10, 6))
plt.title("13Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é (—Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞)")
plt.imshow(g13, cmap="YlOrRd", aspect="auto")
plt.xticks(range(len(g13.columns)), g13.columns, rotation=45)
plt.yticks(range(len(g13.index)), g13.index)
plt.colorbar(label="–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥")
plt.tight_layout()
plt.show()

# 14Ô∏è‚É£ –°—É–¥–∏–º–æ—Å—Ç–∏ —Å—Ä–µ–¥–∏ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∏ –±–µ–∑—Ä–∞–±–æ—Ç–Ω—ã—Ö
plt.figure(figsize=(8, 6))
g14.plot(kind="bar", stacked=True, color=["lightgray", "darkred"])
plt.title("14Ô∏è‚É£ –°—É–¥–∏–º–æ—Å—Ç–∏ —Å—Ä–µ–¥–∏ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∏ –±–µ–∑—Ä–∞–±–æ—Ç–Ω—ã—Ö")
plt.ylabel("–î–æ–ª—è")
plt.xlabel("–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —á–µ–ª–æ–≤–µ–∫")
plt.xticks([0, 1], ["–ë–µ–∑ —Ä–∞–±–æ—Ç—ã", "–†–∞–±–æ—Ç–∞–µ—Ç"], rotation=0)
plt.tight_layout()
plt.show()

# 15Ô∏è‚É£ –ó–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –∏ —Å—É–¥–∏–º–æ—Å—Ç–∏
plt.figure(figsize=(10, 6))
g15.unstack().plot(kind="bar", color=["gray", "darkred"])
plt.title("15Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –∏ —Å—É–¥–∏–º–æ—Å—Ç–∏")
plt.ylabel("–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –≥–æ–¥")
plt.xlabel("–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞")
plt.xticks(rotation=45, ha="right")
plt.legend(title="–°—É–¥–∏–º–æ—Å—Ç—å", bbox_to_anchor=(1.05, 1))
plt.tight_layout()
plt.show()

print("\n‚úÖ –í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
